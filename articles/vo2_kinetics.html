<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>VO2 Kinetics Analysis • whippr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="VO2 Kinetics Analysis">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-126092763-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-126092763-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">whippr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home fa-lg"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book fa-lg"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vo2_kinetics.html">VO2 kinetics analysis</a></li>
    <li><a class="dropdown-item" href="../articles/incremental.html">Incremental test analyses</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-balance-scale"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-newspaper"></span> News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><a class="dropdown-item" href="../news/index.html">Change log</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/fmmattioni/whippr"><span class="fa fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/felipe_mattioni"><span class="fa fa-twitter fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="vo2_kinetics_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="vo2_kinetics_files/d3-4.10.2/d3.min.js"></script><link href="vo2_kinetics_files/collapsibleTree-0.1.6/collapsibleTree.css" rel="stylesheet">
<script src="vo2_kinetics_files/collapsibleTree-binding-0.1.8/collapsibleTree.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>VO2 Kinetics Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fmmattioni/whippr/blob/master/vignettes/vo2_kinetics.Rmd" class="external-link"><code>vignettes/vo2_kinetics.Rmd</code></a></small>
      <div class="d-none name"><code>vo2_kinetics.Rmd</code></div>
    </div>

    
    
<style type="text/css" scoped>
PRE.fansi SPAN {padding-top: .25em; padding-bottom: .25em};
</style>
<div class="rmdinfo">
<p>
Here you may find a walk-through on how to perform VO2 kinetics analysis
in the <strong>moderate-intensity domain</strong>.
</p>
<p>
Functions for analysis in the heavy- and severe-intensity domains will
be added in the near future.
</p>
</div>
<p>For making everyone’s life easier, the general function
<code><a href="../reference/vo2_kinetics.html">vo2_kinetics()</a></code> was created. This function calls smaller
separate functions that <strong>fully</strong> automate the VO2 kinetics
data analysis. The following interactive tree diagram shows how each
function is called:</p>
<div id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:800px;height:300px;" class="collapsibleTree html-widget"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"data":{"name":"VO2 kinetics analysis","children":[{"name":"vo2_kinetics()","children":[{"name":"detect_outliers()","children":[{"name":"normalize_transitions()","children":[{"name":"normalize_first_breath()"}]},{"name":"predict_bands()","children":[{"name":"predict_bands_baseline()"},{"name":"predict_bands_transition()"}]}]},{"name":"plot_outliers()"},{"name":"process_data()","children":[{"name":"interpolate()"},{"name":"perform_average()"},{"name":"normalize_time()"}]},{"name":"perform_kinetics()","children":[{"name":"get_residuals()"},{"name":"model_diagnostics()"}]}]}]},"options":{"hierarchy":["a","b","c","d"],"input":null,"attribute":"leafCount","linkLength":null,"fontSize":10,"tooltip":false,"collapsed":true,"zoomable":false,"margin":{"top":20,"bottom":20,"left":130,"right":155},"fill":"lightsteelblue"}},"evals":[],"jsHooks":[]}</script><div class="section level2">
<h2 id="read-the-data">Read the data<a class="anchor" aria-label="anchor" href="#read-the-data"></a>
</h2>
<p>The first step is to read the raw data with the
<code><a href="../reference/read_data.html">read_data()</a></code> function. Here we are going to use the example
file that comes with <a href="https://fmmattioni.github.io/whippr/" class="external-link">whippr</a>, which is a file exported
from the COSMED metabolic cart.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://fmmattioni.github.io/whippr/" class="external-link">whippr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_data.html">read_data</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"example_cosmed.xlsx"</span>, package <span class="op">=</span> <span class="st">"whippr"</span><span class="op">)</span>, metabolic_cart <span class="op">=</span> <span class="st">"cosmed"</span>, time_column <span class="op">=</span> <span class="st">"t"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw_data</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # Metabolic cart: COSMED </span></span>
<span><span class="co">#&gt; # Data status: raw data</span></span>
<span><span class="co">#&gt; # Time column: t</span></span>
<span><span class="co">#&gt; # A tibble: 754 × 119</span></span>
<span><span class="co">#&gt;        t    Rf    VT    VE   VO2  VCO2 O2exp CO2exp `VE/VO2` `VE/VCO2` `VO2/Kg`</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     2  8.08 1.19   9.60  380.  301.  185.   52.9     25.3      31.9     4.58</span></span>
<span><span class="co">#&gt;  2     4 23.2  0.915 21.2   864.  665.  141.   40.8     24.5      31.9    10.4 </span></span>
<span><span class="co">#&gt;  3     8 15.6  2.11  32.9  1317. 1075.  325.   97.2     25.0      30.6    15.9 </span></span>
<span><span class="co">#&gt;  4    11 20.6  1.18  24.4   894.  714.  188.   49.2     27.3      34.1    10.8 </span></span>
<span><span class="co">#&gt;  5    14 23.3  0.947 22.1   822.  647.  150.   39.4     26.9      34.1     9.90</span></span>
<span><span class="co">#&gt;  6    18 14.7  2.28  33.6  1347. 1126.  351.  108.      24.9      29.8    16.2 </span></span>
<span><span class="co">#&gt;  7    23 11.2  2.32  26.1   980.  848.  364.  107.      26.6      30.7    11.8 </span></span>
<span><span class="co">#&gt;  8    28 13.2  2.18  28.8  1147.  981.  336.  105.      25.2      29.4    13.8 </span></span>
<span><span class="co">#&gt;  9    31 17.7  1.51  26.7  1048.  860.  234.   68.8     25.5      31.0    12.6 </span></span>
<span><span class="co">#&gt; 10    35 14.2  1.68  23.8   973.  794.  257.   79.3     24.5      30.0    11.7 </span></span>
<span><span class="co">#&gt; # ℹ 744 more rows</span></span>
<span><span class="co">#&gt; # ℹ 108 more variables: R &lt;dbl&gt;, FeO2 &lt;dbl&gt;, FeCO2 &lt;dbl&gt;, HR &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `VO2/HR` &lt;dbl&gt;, Load1 &lt;dbl&gt;, Load2 &lt;dbl&gt;, Load3 &lt;dbl&gt;, Phase &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Marker &lt;lgl&gt;, FetO2 &lt;dbl&gt;, FetCO2 &lt;dbl&gt;, FiO2 &lt;dbl&gt;, FiCO2 &lt;dbl&gt;, Ti &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Te &lt;dbl&gt;, Ttot &lt;dbl&gt;, `Ti/Ttot` &lt;dbl&gt;, IV &lt;dbl&gt;, PetO2 &lt;dbl&gt;, PetCO2 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `P(a-et)CO2` &lt;dbl&gt;, SpO2 &lt;dbl&gt;, `VD(phys)` &lt;dbl&gt;, `VD/VT` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Env. Temp.` &lt;dbl&gt;, `Analyz. Temp.` &lt;dbl&gt;, `Analyz. Press.` &lt;dbl&gt;, …</span></span></code></pre>
<p>As you can see in the following graph, this is a protocol where
<strong>3 transitions</strong> from a baseline exercise intensity to to
an exercise intensity below the gas exchange threshold. Therefore, this
is a VO2 kinetics test in the <strong>moderate-intensity
domain</strong>. In this specific case, the following was done:</p>
<ul>
<li>3 x 6-min baseline periods at 20 W.</li>
<li>3 x 6-min transition periods at the power output associated with 90%
of the gas exchange threshold.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">raw_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">VO2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">21</span>, size <span class="op">=</span> <span class="fl">3</span>, fill <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="../reference/theme_whippr.html">theme_whippr</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="vo2_kinetics_files/figure-html/unnamed-chunk-4-1.png" width="2100" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="perform-the-analysis">Perform the analysis<a class="anchor" aria-label="anchor" href="#perform-the-analysis"></a>
</h2>
<p>After reading the raw data, we can move directly to performing the
VO2 kinetics analysis with <code><a href="../reference/vo2_kinetics.html">vo2_kinetics()</a></code>. This function
will:</p>
<ul>
<li>Recognize each baseline and transition phase</li>
<li>Normalize the first breath in each transition in a safe way to
prevent time misalignment</li>
<li>Recognize outliers</li>
<li>Remove outliers</li>
<li>Interpolate each transition</li>
<li>Time-align the data</li>
<li>Ensemble-average the transitions</li>
<li>Perform the chosen bin-average</li>
<li>Fit the final mono-exponential model from VO2 kinetics from the
options chosen</li>
<li>Calculate residuals</li>
</ul>
<div class="rmdinfo">
<p>
For modeling VO2 kinetics analysis in the <strong>moderate-intensity
domain</strong>, a mono-exponential model is used:
</p>
<p>
<span class="math display"><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><msub><mi>O</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>l</mi><mi>i</mi><mi>n</mi><mi>e</mi><mo>+</mo><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>u</mi><mi>d</mi><mi>e</mi><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><msup><mi></mi><mrow><mo>−</mo><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mi>T</mi><mi>D</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>τ</mi></mfrac></mrow></msup></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">VO_2\left(t\right)=baseline+amplitude\cdot\left(1-e^{^{-\frac{\left(t-TD\right)}{τ}}}\right)</annotation></semantics></math></span>
</p>
<p>
where:
</p>
<ul>
<li>
<code>VO2(t)</code> = the oxygen uptake at any given time.
</li>
<li>
<code>baseline</code> = the oxygen uptake associated with the baseline
phase.
</li>
<li>
<code>amplitude</code> = the steady-state increase increase in oxygen
uptake above <code>baseline</code>.
</li>
<li>
<code>TD</code> = the time delay.
</li>
<li>
<code>τ</code> = the time constant defined as the duration of time for
the oxygen uptake to increase to 63% of the steady-state increase.
</li>
</ul>
</div>
<div class="section level3">
<h3 id="important-options">Important options<a class="anchor" aria-label="anchor" href="#important-options"></a>
</h3>
<p>In <code><a href="../reference/vo2_kinetics.html">vo2_kinetics()</a></code> you must set important options before
continuing.</p>
<p><strong>Protocol-related options:</strong></p>
<ul>
<li>
<code>protocol_n_transitions</code> = Number of transitions
performed.</li>
<li>
<code>protocol_baseline_length</code> = The length of the baseline
(in seconds).</li>
<li>
<code>protocol_transition_length</code> = The length of the
transition (in seconds).</li>
</ul>
<p><strong>Data cleaning-related options:</strong></p>
<ul>
<li>
<code>cleaning_level</code> = A numeric scalar between 0 and 1
giving the confidence level for the intervals to be calculated during
the data cleaning process. Breaths lying outside the prediction bands
will be excluded.</li>
<li>
<code>cleaning_baseline_fit</code> = A vector of the same length as
the number in <code>protocol_n_transitions</code>, indicating what kind
of fit to perform for each baseline. Either <em>linear</em> or
<em>exponential</em>.</li>
</ul>
<p><strong>Fitting-related options:</strong></p>
<ul>
<li>
<code>fit_level</code> = A numeric scalar between 0 and 1 giving the
confidence level for the parameter estimates in the final VO2 kinetics
fit.</li>
<li>
<code>fit_bin_average</code> = The bin average to be performed for
the final fit.</li>
<li>
<code>fit_phase_1_length</code> = The length of the phase I that you
wish to exclude from the final exponential fit, in seconds.</li>
<li>
<code>fit_baseline_length</code> = The length the baseline to
perform the final linear fit, in seconds.</li>
<li>
<code>fit_transition_length</code> = The length of the transition to
perform the final exponential fit, in seconds.</li>
</ul>
<p>The analysis is performed like the following:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/vo2_kinetics.html">vo2_kinetics</a></span><span class="op">(</span></span>
<span>  .data <span class="op">=</span> <span class="va">raw_data</span>,</span>
<span>  intensity_domain <span class="op">=</span> <span class="st">"moderate"</span>,</span>
<span>  vo2_column <span class="op">=</span> <span class="st">"VO2"</span>,</span>
<span>  protocol_n_transitions <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  protocol_baseline_length <span class="op">=</span> <span class="fl">360</span>,</span>
<span>  protocol_transition_length <span class="op">=</span> <span class="fl">360</span>,</span>
<span>  cleaning_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  cleaning_baseline_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"exponential"</span>, <span class="st">"exponential"</span><span class="op">)</span>,</span>
<span>  fit_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  fit_bin_average <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  fit_phase_1_length <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  fit_baseline_length <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  fit_transition_length <span class="op">=</span> <span class="fl">240</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ──────────────────────────  * V̇O₂ kinetics analysis *  ─────────────────────────</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔ Detecting outliers</span></span></code></pre>
<pre><code><span><span class="co">#&gt; • 14 outliers found in transition 1</span></span>
<span><span class="co">#&gt; • 15 outliers found in transition 2</span></span>
<span><span class="co">#&gt; • 13 outliers found in transition 3</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔ Processing data...</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Removing outliers</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Interpolating each transition</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Ensemble-averaging transitions</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Performing 5-s bin averages</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔ Fitting data...</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Fitting baseline</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Fitting transition</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Calculating residuals</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ✔       └─ Preparing plots</span></span></code></pre>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ──────────────────────────────────  * DONE *  ──────────────────────────────────</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">results</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 1 × 9</span></span>
<span><span class="co">#&gt;   data_outliers plot_outliers data_processed data_fitted model  model_summary   </span></span>
<span><span class="co">#&gt;   &lt;list&gt;        &lt;list&gt;        &lt;list&gt;         &lt;list&gt;      &lt;list&gt; &lt;list&gt;          </span></span>
<span><span class="co">#&gt; 1 &lt;whippr&gt;      &lt;patchwrk&gt;    &lt;whippr&gt;       &lt;tibble&gt;    &lt;nls&gt;  &lt;tibble [4 × 7]&gt;</span></span>
<span><span class="co">#&gt; # ℹ 3 more variables: model_residuals &lt;list&gt;, plot_model &lt;list&gt;,</span></span>
<span><span class="co">#&gt; #   plot_residuals &lt;list&gt;</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="fit-parameters">Fit parameters<a class="anchor" aria-label="anchor" href="#fit-parameters"></a>
</h2>
<p>Fit parameters and confidence intervals may be accessed through the
<strong>model_summary</strong> column.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">model_summary</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 4 × 7</span></span>
<span><span class="co">#&gt;   term     estimate std.error statistic  p.value conf.low conf.high</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 baseline   1026.      14.3       71.7 1.65e-29   997.      1056. </span></span>
<span><span class="co">#&gt; 2 Amp        2062.      11.4      182.  1.95e-62  2039.      2085. </span></span>
<span><span class="co">#&gt; 3 TD           12.0      1.04      11.6 1.09e-14     9.93      14.1</span></span>
<span><span class="co">#&gt; 4 tau          22.7      1.28      17.7 4.15e-21    20.1       25.3</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="fit-plot">Fit plot<a class="anchor" aria-label="anchor" href="#fit-plot"></a>
</h2>
<p>The fit plot may be accessed through the <strong>plot_model</strong>
column.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">plot_model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Warning: Removed 24 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span>
<span><span class="co">#&gt; Removed 24 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="vo2_kinetics_files/figure-html/unnamed-chunk-8-1.png" width="2100" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="checking-what-was-done-during-data-cleaning">Checking what was done during data cleaning<a class="anchor" aria-label="anchor" href="#checking-what-was-done-during-data-cleaning"></a>
</h2>
<p>The data cleaning process may be accessed through the
<strong>plot_outliers</strong> column.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">plot_outliers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="vo2_kinetics_files/figure-html/unnamed-chunk-9-1.png" width="3600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="model-diagnostics">Model diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a>
</h2>
<p>Model residuals plot may be accessed through the
<strong>plot_residuals</strong> column.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">plot_residuals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p><img src="vo2_kinetics_files/figure-html/unnamed-chunk-10-1.png" width="3600" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="additional-columns">Additional columns<a class="anchor" aria-label="anchor" href="#additional-columns"></a>
</h2>
<div class="section level3">
<h3 id="raw-data-with-detected-outliers">Raw data with detected outliers<a class="anchor" aria-label="anchor" href="#raw-data-with-detected-outliers"></a>
</h3>
<p>The raw data with additional columns from the data cleaning process
may be accessed through the <strong>data_outliers</strong> column.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">data_outliers</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # Metabolic cart: COSMED </span></span>
<span><span class="co">#&gt; # Data status: raw data - outliers detected</span></span>
<span><span class="co">#&gt; # Time column: t</span></span>
<span><span class="co">#&gt; # VO2 column: VO2</span></span>
<span><span class="co">#&gt; # Test type: kinetics</span></span>
<span><span class="co">#&gt; # A tibble: 757 × 131</span></span>
<span><span class="co">#&gt;        t    Rf    VT    VE   VO2  VCO2 O2exp CO2exp `VE/VO2` `VE/VCO2` `VO2/Kg`</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     0  8.08 1.19   9.60  380.  301.  185.   52.9     25.3      31.9     4.58</span></span>
<span><span class="co">#&gt;  2     2  8.08 1.19   9.60  380.  301.  185.   52.9     25.3      31.9     4.58</span></span>
<span><span class="co">#&gt;  3     4 23.2  0.915 21.2   864.  665.  141.   40.8     24.5      31.9    10.4 </span></span>
<span><span class="co">#&gt;  4     8 15.6  2.11  32.9  1317. 1075.  325.   97.2     25.0      30.6    15.9 </span></span>
<span><span class="co">#&gt;  5    11 20.6  1.18  24.4   894.  714.  188.   49.2     27.3      34.1    10.8 </span></span>
<span><span class="co">#&gt;  6    14 23.3  0.947 22.1   822.  647.  150.   39.4     26.9      34.1     9.90</span></span>
<span><span class="co">#&gt;  7    18 14.7  2.28  33.6  1347. 1126.  351.  108.      24.9      29.8    16.2 </span></span>
<span><span class="co">#&gt;  8    23 11.2  2.32  26.1   980.  848.  364.  107.      26.6      30.7    11.8 </span></span>
<span><span class="co">#&gt;  9    28 13.2  2.18  28.8  1147.  981.  336.  105.      25.2      29.4    13.8 </span></span>
<span><span class="co">#&gt; 10    31 17.7  1.51  26.7  1048.  860.  234.   68.8     25.5      31.0    12.6 </span></span>
<span><span class="co">#&gt; # ℹ 747 more rows</span></span>
<span><span class="co">#&gt; # ℹ 120 more variables: R &lt;dbl&gt;, FeO2 &lt;dbl&gt;, FeCO2 &lt;dbl&gt;, HR &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `VO2/HR` &lt;dbl&gt;, Load1 &lt;dbl&gt;, Load2 &lt;dbl&gt;, Load3 &lt;dbl&gt;, Phase &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Marker &lt;lgl&gt;, FetO2 &lt;dbl&gt;, FetCO2 &lt;dbl&gt;, FiO2 &lt;dbl&gt;, FiCO2 &lt;dbl&gt;, Ti &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Te &lt;dbl&gt;, Ttot &lt;dbl&gt;, `Ti/Ttot` &lt;dbl&gt;, IV &lt;dbl&gt;, PetO2 &lt;dbl&gt;, PetCO2 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `P(a-et)CO2` &lt;dbl&gt;, SpO2 &lt;dbl&gt;, `VD(phys)` &lt;dbl&gt;, `VD/VT` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Env. Temp.` &lt;dbl&gt;, `Analyz. Temp.` &lt;dbl&gt;, `Analyz. Press.` &lt;dbl&gt;, …</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="processed-data">Processed data<a class="anchor" aria-label="anchor" href="#processed-data"></a>
</h3>
<p>The processed data (cleaned, interpolated, time-aligned,
ensemble-averaged, and bin-averaged) may be accessed through the
<strong>data_processed</strong> column.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">data_processed</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # Metabolic cart: COSMED </span></span>
<span><span class="co">#&gt; # Data status: processed data - 5-s bin averaged</span></span>
<span><span class="co">#&gt; # Time column: t</span></span>
<span><span class="co">#&gt; # VO2 column: VO2</span></span>
<span><span class="co">#&gt; # Test type: kinetics</span></span>
<span><span class="co">#&gt; # A tibble: 145 × 114</span></span>
<span><span class="co">#&gt;        t    Rf    VT    VE   VO2  VCO2 O2exp CO2exp `VE/VO2` `VE/VCO2` `VO2/Kg`</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  -360  27.4  2.78  76.1 3152. 2831.  421.   146.     24.2      26.9     38.0</span></span>
<span><span class="co">#&gt;  2  -355  25.9  2.63  68.7 2781. 2508.  402.   136.     24.8      27.8     33.5</span></span>
<span><span class="co">#&gt;  3  -350  24.1  2.32  56.4 2314. 2012.  356.   117.     24.7      28.8     27.9</span></span>
<span><span class="co">#&gt;  4  -345  24.0  2.01  49.0 2014. 1786.  306.   104.     24.9      29.0     24.3</span></span>
<span><span class="co">#&gt;  5  -340  22.1  2.26  49.8 2085. 1865.  342.   118.     24.2      27.5     25.1</span></span>
<span><span class="co">#&gt;  6  -335  20.6  2.25  45.5 1834. 1667.  344.   115.     25.1      27.9     22.1</span></span>
<span><span class="co">#&gt;  7  -330  18.4  2.47  45.6 1844. 1704.  376.   130.     24.8      27.3     22.2</span></span>
<span><span class="co">#&gt;  8  -325  19.4  2.35  46.6 1786. 1707.  363.   121.     25.9      28.0     21.5</span></span>
<span><span class="co">#&gt;  9  -320  20.1  2.00  41.0 1548. 1484.  310.   103.     26.0      27.9     18.7</span></span>
<span><span class="co">#&gt; 10  -315  20.3  2.08  42.1 1580. 1517.  324.   106.     26.3      28.2     19.0</span></span>
<span><span class="co">#&gt; # ℹ 135 more rows</span></span>
<span><span class="co">#&gt; # ℹ 103 more variables: R &lt;dbl&gt;, FeO2 &lt;dbl&gt;, FeCO2 &lt;dbl&gt;, HR &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `VO2/HR` &lt;dbl&gt;, Load1 &lt;dbl&gt;, Load2 &lt;dbl&gt;, Load3 &lt;dbl&gt;, Phase &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   FetO2 &lt;dbl&gt;, FetCO2 &lt;dbl&gt;, FiO2 &lt;dbl&gt;, FiCO2 &lt;dbl&gt;, Ti &lt;dbl&gt;, Te &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   Ttot &lt;dbl&gt;, `Ti/Ttot` &lt;dbl&gt;, IV &lt;dbl&gt;, PetO2 &lt;dbl&gt;, PetCO2 &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `P(a-et)CO2` &lt;dbl&gt;, SpO2 &lt;dbl&gt;, `VD(phys)` &lt;dbl&gt;, `VD/VT` &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   `Env. Temp.` &lt;dbl&gt;, `Analyz. Temp.` &lt;dbl&gt;, `Analyz. Press.` &lt;dbl&gt;, …</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="fitted-data">Fitted data<a class="anchor" aria-label="anchor" href="#fitted-data"></a>
</h3>
<p>The data from the baseline and transition fits may be accessed
through the <strong>data_fitted</strong> column.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">data_fitted</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 70 × 8</span></span>
<span><span class="co">#&gt;        t   VO2 .fitted .resid   .hat .sigma .cooksd .std.resid</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1  -120  987.   1026.  -39.4 0.0400   72.7 0.0132      -0.562</span></span>
<span><span class="co">#&gt;  2  -115  991.   1026.  -35.3 0.04     72.7 0.0105      -0.503</span></span>
<span><span class="co">#&gt;  3  -110 1126.   1026.  100.  0.04     70.0 0.0849       1.43 </span></span>
<span><span class="co">#&gt;  4  -105 1058.   1026.   31.6 0.04     72.8 0.00845      0.450</span></span>
<span><span class="co">#&gt;  5  -100 1040.   1026.   14.0 0.04     73.1 0.00165      0.199</span></span>
<span><span class="co">#&gt;  6   -95 1051.   1026.   24.6 0.04     72.9 0.00511      0.350</span></span>
<span><span class="co">#&gt;  7   -90 1052.   1026.   26.2 0.04     72.9 0.00582      0.374</span></span>
<span><span class="co">#&gt;  8   -85 1068.   1026.   41.3 0.04     72.6 0.0145       0.589</span></span>
<span><span class="co">#&gt;  9   -80 1054.   1026.   27.7 0.04     72.9 0.00648      0.394</span></span>
<span><span class="co">#&gt; 10   -75  986.   1026.  -40.1 0.04     72.6 0.0136      -0.572</span></span>
<span><span class="co">#&gt; # ℹ 60 more rows</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h3>
<p>The model used for fitting the mono-exponential model may be accessed
through the <strong>model</strong> column.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; Nonlinear regression model</span></span>
<span><span class="co">#&gt;   model: VO2 ~ 1026.23750312602 + Amp * (1 - exp(-(t - TD)/tau))</span></span>
<span><span class="co">#&gt;    data: data_transition</span></span>
<span><span class="co">#&gt;     Amp      TD     tau </span></span>
<span><span class="co">#&gt; 2062.08   12.02   22.71 </span></span>
<span><span class="co">#&gt;  residual sum-of-squares: 145152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 6 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 1.49e-08</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula: VO2 ~ 1026.23750312602 + Amp * (1 - exp(-(t - TD)/tau))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;     Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; Amp 2062.079     11.361  181.51  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; TD    12.021      1.036   11.61 1.09e-14 ***</span></span>
<span><span class="co">#&gt; tau   22.712      1.281   17.72  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 58.79 on 42 degrees of freedom</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of iterations to convergence: 6 </span></span>
<span><span class="co">#&gt; Achieved convergence tolerance: 1.49e-08</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="residuals-data">Residuals data<a class="anchor" aria-label="anchor" href="#residuals-data"></a>
</h3>
<p>The model residuals data may be accessed through the
<strong>model_residuals</strong> column.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span><span class="op">$</span><span class="va">model_residuals</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 45 × 7</span></span>
<span><span class="co">#&gt;        t   VO2 .fitted  .resid standardized_residuals sqrt_abs_standardized_re…¹</span></span>
<span><span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;                  &lt;dbl&gt;                      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1    20 1731.   1637.   94.3                   1.60                       1.27 </span></span>
<span><span class="co">#&gt;  2    25 1890.   1924.  -33.6                  -0.572                      0.757</span></span>
<span><span class="co">#&gt;  3    30 2037.   2154. -117.                   -1.98                       1.41 </span></span>
<span><span class="co">#&gt;  4    35 2319.   2339.  -19.3                  -0.328                      0.573</span></span>
<span><span class="co">#&gt;  5    40 2452.   2487.  -34.7                  -0.591                      0.769</span></span>
<span><span class="co">#&gt;  6    45 2636.   2606.   30.3                   0.516                      0.718</span></span>
<span><span class="co">#&gt;  7    50 2693.   2701.   -8.09                 -0.138                      0.371</span></span>
<span><span class="co">#&gt;  8    55 2820.   2778.   43.0                   0.731                      0.855</span></span>
<span><span class="co">#&gt;  9    60 2907.   2839.   68.2                   1.16                       1.08 </span></span>
<span><span class="co">#&gt; 10    65 2903.   2888.   14.9                   0.253                      0.503</span></span>
<span><span class="co">#&gt; # ℹ 35 more rows</span></span>
<span><span class="co">#&gt; # ℹ abbreviated name: ¹​sqrt_abs_standardized_residuals</span></span>
<span><span class="co">#&gt; # ℹ 1 more variable: lag_residuals &lt;dbl&gt;</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://fmattioni.me" class="external-link">Felipe Mattioni Maturana</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
